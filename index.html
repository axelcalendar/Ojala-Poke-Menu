<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Poke Bar â€“ Online Menu & Builder</title>
  <!-- Tailwind via CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- React 18 UMD + ReactDOM -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <!-- Babel for in-browser JSX transform -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="bg-emerald-50/40">
  <div id="root"></div>

  <script type="text/babel">
    const { useMemo, useState } = React;

    /* =====================
     * TRANSLATIONS (ES/EN/IT/FR)
     * ===================== */
    const translations = {
      es: {
        flagsLabel: "Idioma",
        ui: {
          title: "Poke Bar",
          chefBowls: "Bowls del chef",
          buildTitle: "Crea tu poke",
          limitsHint: "Elige hasta: 1 base, 1 proteÃ­na, 4 toppings, 1 salsa, 1 crujiente.",
          basePriceLabel: "Precio base bowl",
          extras: "Extras",
          base: "Base",
          protein: "ProteÃ­na",
          toppings: "Toppings",
          sauce: "Salsa",
          crunchy: "Crujiente",
          detailsSummary: "Datos y resumen",
          customerNameOptional: "Nombre del cliente (opcional)",
          pickupNote: "*Pedido para recogida en local.",
          presetsSection: "Preset Bowls",
          customSection: "Custom Bowl",
          subtotalPresets: "Subtotal presets",
          subtotalCustom: "Subtotal custom",
          total: "Total pedido",
          sendWhatsapp: "Enviar por WhatsApp",
          reset: "Reiniciar",
          address: "C/Lepanto 13L Â· Tel. 666 33 19 17 Â· Fuerteventura",
          chefReady: "Bowl listo del chef",
        },
        presets: {
          el_clasico: "El ClÃ¡sico",
          bristol: "Bristol",
          doramas: "Doramas",
          ventahor: "Ventahor",
          pulp_fiction: "Pulp Fiction",
          ico: "Ico",
        },
        ingredients: {
          arroz_sushi: "Arroz sushi", quinoa: "Quinoa", ensalada: "Ensalada",
          salmon_crudo: "SalmÃ³n (crudo)", salmon_tataki: "SalmÃ³n tataki", salmon_teriyaki: "SalmÃ³n teriyaki",
          atun_crudo: "AtÃºn (crudo)", atun_tataki: "AtÃºn tataki", pulpo: "Pulpo", tofu_plancha: "Tofu a la plancha",
          pollo_teriyaki: "Pollo teriyaki",
          aguacate: "Aguacate", mango: "Mango", wakame: "Alga wakame", edamame: "Edamame",
          cebolla_caramelizada: "Cebolla caramelizada", cebolla_encurtida: "Cebolla encurtida",
          zanahoria: "Zanahoria", calabaza: "Calabaza", calabacin_grill: "CalabacÃ­n parrillado",
          tomate_cherry: "Tomate cherry", tomate_seco: "Tomate seco", pepino: "Pepino",
          col_morada: "Col morada", philadelphia: "Philadelphia", feta: "Queso feta",
          jengibre_encurtido: "Jengibre encurtido", huevas_pez: "Huevas de pescado",
          spicy_mayo: "Spicy mayonesa", soja: "Soja", soja_sg: "Soja sin gluten",
          sriracha: "Salsa sriracha ðŸŒ¶", salsa_mango: "Salsa de mango", wasabi_cream: "Wasabi cream",
          teriyaki: "Teriyaki", salsa_curry: "Salsa curry",
          cebolla_crujiente: "Cebolla crujiente", pistacho: "Pistacho", almendra: "Almendra",
          anacardo: "Anacardo", nori_crujiente: "Alga nori crujiente", mix_semillas: "Mix de semillas",
        },
      },
      en: {
        flagsLabel: "Language",
        ui: {
          title: "Poke Bar",
          chefBowls: "Chef bowls",
          buildTitle: "Create your poke",
          limitsHint: "Choose up to: 1 base, 1 protein, 4 toppings, 1 sauce, 1 crunchy.",
          basePriceLabel: "Bowl base price",
          extras: "Extras",
          base: "Base",
          protein: "Protein",
          toppings: "Toppings",
          sauce: "Sauce",
          crunchy: "Crunchy",
          detailsSummary: "Details & summary",
          customerNameOptional: "Customer name (optional)",
          pickupNote: "*Order for pick-up at the restaurant.",
          presetsSection: "Preset Bowls",
          customSection: "Custom Bowl",
          subtotalPresets: "Presets subtotal",
          subtotalCustom: "Custom subtotal",
          total: "Order total",
          sendWhatsapp: "Send via WhatsApp",
          reset: "Reset",
          address: "C/Lepanto 13L Â· Tel. 666 33 19 17 Â· Fuerteventura",
          chefReady: "Chef-ready bowl",
        },
        presets: {
          el_clasico: "The Classic",
          bristol: "Bristol",
          doramas: "Doramas",
          ventahor: "Ventahor",
          pulp_fiction: "Pulp Fiction",
          ico: "Ico",
        },
        ingredients: {
          arroz_sushi: "Sushi rice", quinoa: "Quinoa", ensalada: "Salad",
          salmon_crudo: "Salmon (raw)", salmon_tataki: "Salmon tataki", salmon_teriyaki: "Salmon teriyaki",
          atun_crudo: "Tuna (raw)", atun_tataki: "Tuna tataki", pulpo: "Octopus", tofu_plancha: "Grilled tofu",
          pollo_teriyaki: "Teriyaki chicken",
          aguacate: "Avocado", mango: "Mango", wakame: "Wakame seaweed", edamame: "Edamame",
          cebolla_caramelizada: "Caramelized onion", cebolla_encurtida: "Pickled onion",
          zanahoria: "Carrot", calabaza: "Pumpkin", calabacin_grill: "Grilled zucchini",
          tomate_cherry: "Cherry tomato", tomate_seco: "Sun-dried tomato", pepino: "Cucumber",
          col_morada: "Red cabbage", philadelphia: "Cream cheese", feta: "Feta cheese",
          jengibre_encurtido: "Pickled ginger", huevas_pez: "Fish roe",
          spicy_mayo: "Spicy mayo", soja: "Soy sauce", soja_sg: "Gluten-free soy sauce",
          sriracha: "Sriracha sauce ðŸŒ¶", salsa_mango: "Mango sauce", wasabi_cream: "Wasabi cream",
          teriyaki: "Teriyaki", salsa_curry: "Curry sauce",
          cebolla_crujiente: "Crispy onion", pistacho: "Pistachio", almendra: "Almond",
          anacardo: "Cashew", nori_crujiente: "Crispy nori", mix_semillas: "Seed mix",
        },
      },
      it: {
        flagsLabel: "Lingua",
        ui: {
          title: "Poke Bar",
          chefBowls: "Bowls dello chef",
          buildTitle: "Crea il tuo poke",
          limitsHint: "Scegli fino a: 1 base, 1 proteina, 4 toppings, 1 salsa, 1 croccante.",
          basePriceLabel: "Prezzo base bowl",
          extras: "Extra",
          base: "Base",
          protein: "Proteina",
          toppings: "Toppings",
          sauce: "Salsa",
          crunchy: "Croccante",
          detailsSummary: "Dati e riepilogo",
          customerNameOptional: "Nome del cliente (opzionale)",
          pickupNote: "*Ordine per ritiro in loco.",
          presetsSection: "Bowls predefiniti",
          customSection: "Bowl personalizzato",
          subtotalPresets: "Subtotale predefiniti",
          subtotalCustom: "Subtotale personalizzati",
          total: "Totale ordine",
          sendWhatsapp: "Invia via WhatsApp",
          reset: "Reimposta",
          address: "C/Lepanto 13L Â· Tel. 666 33 19 17 Â· Fuerteventura",
          chefReady: "Bowl pronto dello chef",
        },
        presets: {
          el_clasico: "Il Classico",
          bristol: "Bristol",
          doramas: "Doramas",
          ventahor: "Ventahor",
          pulp_fiction: "Pulp Fiction",
          ico: "Ico",
        },
        ingredients: {
          arroz_sushi: "Riso sushi", quinoa: "Quinoa", ensalada: "Insalata",
          salmon_crudo: "Salmone (crudo)", salmon_tataki: "Salmone tataki", salmon_teriyaki: "Salmone teriyaki",
          atun_crudo: "Tonno (crudo)", atun_tataki: "Tonno tataki", pulpo: "Polpo", tofu_plancha: "Tofu alla piastra",
          pollo_teriyaki: "Pollo teriyaki",
          aguacate: "Avocado", mango: "Mango", wakame: "Alga wakame", edamame: "Edamame",
          cebolla_caramelizada: "Cipolla caramellata", cebolla_encurtida: "Cipolla marinata",
          zanahoria: "Carota", calabaza: "Zucca", calabacin_grill: "Zucchina grigliata",
          tomate_cherry: "Pomodorini", tomate_seco: "Pomodoro secco", pepino: "Cetriolo",
          col_morada: "Cavolo rosso", philadelphia: "Formaggio cremoso", feta: "Formaggio feta",
          jengibre_encurtido: "Zenzero marinato", huevas_pez: "Uova di pesce",
          spicy_mayo: "Maionese piccante", soja: "Salsa di soia", soja_sg: "Salsa di soia senza glutine",
          sriracha: "Salsa sriracha ðŸŒ¶", salsa_mango: "Salsa di mango", wasabi_cream: "Crema al wasabi",
          teriyaki: "Teriyaki", salsa_curry: "Salsa al curry",
          cebolla_crujiente: "Cipolla croccante", pistacho: "Pistacchio", almendra: "Mandorla",
          anacardo: "Anacardo", nori_crujiente: "Nori croccante", mix_semillas: "Mix di semi",
        },
      },
      fr: {
        flagsLabel: "Langue",
        ui: {
          title: "Poke Bar",
          chefBowls: "Bowls du chef",
          buildTitle: "CrÃ©e ton poke",
          limitsHint: "Choisis jusquâ€™Ã  : 1 base, 1 protÃ©ine, 4 toppings, 1 sauce, 1 croustillant.",
          basePriceLabel: "Prix de base du bowl",
          extras: "Extras",
          base: "Base",
          protein: "ProtÃ©ine",
          toppings: "Toppings",
          sauce: "Sauce",
          crunchy: "Croustillant",
          detailsSummary: "Infos & rÃ©capitulatif",
          customerNameOptional: "Nom du client (optionnel)",
          pickupNote: "*Commande Ã  rÃ©cupÃ©rer sur place.",
          presetsSection: "Bowls prÃ©dÃ©finis",
          customSection: "Bowl personnalisÃ©",
          subtotalPresets: "Sous-total prÃ©dÃ©finis",
          subtotalCustom: "Sous-total personnalisÃ©s",
          total: "Total commande",
          sendWhatsapp: "Envoyer via WhatsApp",
          reset: "RÃ©initialiser",
          address: "C/Lepanto 13L Â· TÃ©l. 666 33 19 17 Â· Fuerteventura",
          chefReady: "Bowl prÃªt du chef",
        },
        presets: {
          el_clasico: "Le Classique",
          bristol: "Bristol",
          doramas: "Doramas",
          ventahor: "Ventahor",
          pulp_fiction: "Pulp Fiction",
          ico: "Ico",
        },
        ingredients: {
          arroz_sushi: "Riz Ã  sushi", quinoa: "Quinoa", ensalada: "Salade",
          salmon_crudo: "Saumon (cru)", salmon_tataki: "Saumon tataki", salmon_teriyaki: "Saumon teriyaki",
          atun_crudo: "Thon (cru)", atun_tataki: "Thon tataki", pulpo: "Poulpe", tofu_plancha: "Tofu grillÃ©",
          pollo_teriyaki: "Poulet teriyaki",
          aguacate: "Avocat", mango: "Mangue", wakame: "Algues wakame", edamame: "Edamame",
          cebolla_caramelizada: "Oignon caramÃ©lisÃ©", cebolla_encurtida: "Oignon marinÃ©",
          zanahoria: "Carotte", calabaza: "Potiron", calabacin_grill: "Courgette grillÃ©e",
          tomate_cherry: "Tomate cerise", tomate_seco: "Tomate sÃ©chÃ©e", pepino: "Concombre",
          col_morada: "Chou rouge", philadelphia: "Fromage frais", feta: "Fromage feta",
          jengibre_encurtido: "Gingembre marinÃ©", huevas_pez: "Å’ufs de poisson",
          spicy_mayo: "Mayonnaise Ã©picÃ©e", soja: "Sauce soja", soja_sg: "Sauce soja sans gluten",
          sriracha: "Sauce sriracha ðŸŒ¶", salsa_mango: "Sauce mangue", wasabi_cream: "CrÃ¨me wasabi",
          teriyaki: "Teriyaki", salsa_curry: "Sauce curry",
          cebolla_crujiente: "Oignon croustillant", pistacho: "Pistache", almendra: "Amande",
          anacardo: "Noix de cajou", nori_crujiente: "Nori croustillant", mix_semillas: "MÃ©lange de graines",
        },
      },
    };

    // Ingredient keys
    const BASES = ["arroz_sushi", "quinoa", "ensalada"];
    const PROTEINS = [
      "salmon_crudo","salmon_tataki","salmon_teriyaki",
      "atun_crudo","atun_tataki","pulpo","tofu_plancha","pollo_teriyaki"
    ];
    const TOPPINGS = [
      "aguacate","mango","wakame","edamame","cebolla_caramelizada","cebolla_encurtida",
      "zanahoria","calabaza","calabacin_grill","tomate_cherry","tomate_seco","pepino",
      "col_morada","philadelphia","feta","jengibre_encurtido","huevas_pez"
    ];
    const SAUCES = [
      "spicy_mayo","soja","soja_sg","sriracha","salsa_mango","wasabi_cream","teriyaki","salsa_curry"
    ];
    const CRUNCHY = ["cebolla_crujiente","pistacho","almendra","anacardo","nori_crujiente","mix_semillas"];

    // Presets with keys for translation
    const PRESETS = [
      { key: "el_clasico", price: 13 },
      { key: "bristol", price: 15 },
      { key: "doramas", price: 15 },
      { key: "ventahor", price: 14 },
      { key: "pulp_fiction", price: 15 },
      { key: "ico", price: 14 },
    ];

    const LIMITS = { base: 1, protein: 1, toppings: 4, sauce: 1, crunchy: 1 };
    const EXTRA_PRICES = { base: 2, protein: 3, toppings: 1.5, sauce: 1, crunchy: 1.5 };
    const BASE_PRICE = 13;

    const Section = ({ title, children, hint }) => (
      <section className="mb-6">
        <div className="flex items-end justify-between">
          <h2 className="text-xl font-semibold">{title}</h2>
          {hint && <p className="text-sm text-gray-500">{hint}</p>}
        </div>
        <div className="mt-3 grid gap-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4">{children}</div>
      </section>
    );

    const Chip = ({ label, selected, disabled, onClick, extraNote }) => (
      <button
        className={
          "text-left rounded-2xl border px-4 py-3 shadow-sm transition " +
          (selected ? "border-emerald-500 ring-2 ring-emerald-200 bg-white " : "border-gray-200 hover:border-gray-300 bg-white ") +
          (disabled ? "opacity-50 cursor-not-allowed" : "cursor-pointer")
        }
        onClick={onClick}
        disabled={disabled}
        type="button"
      >
        <div className="flex items-center justify-between gap-3">
          <span className="font-medium">{label}</span>
          {selected && <span className="inline-flex h-5 w-5 items-center justify-center rounded-full bg-emerald-500 text-white text-xs">âœ“</span>}
        </div>
        {extraNote && <div className="mt-1 text-xs text-gray-500">{extraNote}</div>}
      </button>
    );

    const PresetChip = ({ label, price, selected, onClick }) => (
      <button
        type="button"
        onClick={onClick}
        className={
          "rounded-2xl border p-5 text-left shadow-sm transition w-full " +
          (selected ? "border-emerald-500 ring-2 ring-emerald-200 bg-emerald-50 " : "border-gray-200 bg-white hover:border-gray-300 ")
        }
      >
        <div className="flex items-center justify-between">
          <div>
            <h3 className="text-lg font-semibold">{label}</h3>
            <p className="text-sm text-gray-500">{/* chef tag set below by t */}</p>
          </div>
          <div className="flex items-center gap-2">
            <span className="text-lg font-bold">{price} â‚¬</span>
            {selected && (
              <span className="inline-flex h-5 w-5 items-center justify-center rounded-full bg-emerald-500 text-white text-xs">âœ“</span>
            )}
          </div>
        </div>
      </button>
    );

    function App() {
      // Language state
      const [lang, setLang] = useState("es");
      const t = (section, key) => translations[lang][section][key];
      const ti = (key) => translations[lang].ingredients[key];
      const tp = (key) => translations[lang].presets[key];

      // Selections
      const [selection, setSelection] = useState({ base: [], protein: [], toppings: [], sauce: [], crunchy: [] });
      const [presetOrders, setPresetOrders] = useState([]); // array of preset keys
      const [customerName, setCustomerName] = useState(""); // optional

      const hasPersonalized = selection.base.length > 0; // personalized bowl active if a base is chosen
      // Disable ingredients (except Base) when any preset selected and no base picked yet
      const disableNonBaseIngredients = presetOrders.length > 0 && !hasPersonalized;

      const extras = useMemo(() => {
        const out = {};
        Object.keys(LIMITS).forEach((k) => {
          const over = Math.max(0, (selection[k] || []).length - LIMITS[k]);
          out[k] = over * EXTRA_PRICES[k];
        });
        return out;
      }, [selection]);

      const extrasTotal = Object.values(extras).reduce((a, b) => a + b, 0);
      const personalizedSubtotal = hasPersonalized ? (BASE_PRICE + extrasTotal) : 0;
      const presetsSubtotal = presetOrders
        .map((k) => PRESETS.find((p) => p.key === k)?.price || 0)
        .reduce((a, b) => a + b, 0);
      const orderTotal = (personalizedSubtotal + presetsSubtotal).toFixed(2);

      const toggle = (group, itemKey) => {
        setSelection((prev) => {
          const exists = prev[group].includes(itemKey);
          const next = exists ? prev[group].filter((i) => i !== itemKey) : [...prev[group], itemKey];
          return { ...prev, [group]: next };
        });
      };

      const isPresetSelected = (key) => presetOrders.includes(key);
      const togglePreset = (key) => {
        setPresetOrders((prev) => (
          prev.includes(key) ? prev.filter((k) => k !== key) : [...prev, key]
        ));
      };

      const reset = () => {
        setSelection({ base: [], protein: [], toppings: [], sauce: [], crunchy: [] });
        setPresetOrders([]);
        setCustomerName("");
      };

      const listBlock = (arr) => (arr.length ? ("\n- " + arr.map(ti).join("\n- ")) : " -");

      const shareText = () => {
        const ui = translations[lang].ui;
        const lines = [];
        if (customerName.trim()) lines.push(`${ui.customerNameOptional.replace(" (opcional)", "").replace(" (optional)", "").replace(" (opzionale)", "").replace(" (optionnel)", "")}: ${customerName.trim()}`);
        lines.push(ui.pickupNote.replace("*", "").trim());
        lines.push("");

        if (presetOrders.length > 0) {
          lines.push(`${ui.presetsSection}:`);
          const counts = presetOrders.reduce((acc, k) => { acc[k] = (acc[k] || 0) + 1; return acc; }, {});
          Object.entries(counts).forEach(([k, c]) => lines.push(`${tp(k)} Ã—${c}`));
          lines.push(`${ui.subtotalPresets}: ${presetsSubtotal.toFixed(2)} â‚¬`);
          lines.push("");
        }

        if (hasPersonalized) {
          lines.push(`${ui.customSection}:`);
          lines.push(`${ui.base}:${listBlock(selection.base)}`);
          lines.push(`${ui.protein}:${listBlock(selection.protein)}`);
          lines.push(`${ui.toppings}:${listBlock(selection.toppings)}`);
          lines.push(`${ui.sauce}:${listBlock(selection.sauce)}`);
          lines.push(`${ui.crunchy}:${listBlock(selection.crunchy)}`);
          lines.push(`${ui.subtotalCustom}: ${personalizedSubtotal.toFixed(2)} â‚¬`);
          lines.push("");
        }

        lines.push(`${ui.total}: ${orderTotal} â‚¬`);
        return encodeURIComponent(lines.join("\n"));
      };

      const hasAnyOrder = hasPersonalized || presetOrders.length > 0;
      const whatsappHref = hasAnyOrder
        ? `https://wa.me/34666331917?text=${shareText()}`
        : "#";

      return (
        <div className="min-h-screen">
          {/* Header with flags */}
          <header className="sticky top-0 z-10 bg-white/80 backdrop-blur border-b">
            <div className="mx-auto max-w-6xl px-4 py-4 flex flex-col gap-3 md:flex-row md:items-center md:justify-between">
              <div className="flex items-center gap-3">
                <h1 className="text-2xl font-bold tracking-tight">{t('ui','title')}</h1>
                <span className="text-sm text-gray-400">Â·</span>
                <div className="text-sm text-gray-600">{translations[lang].flagsLabel}:</div>
                <div className="flex gap-2">
                  <button className={"px-2 py-1 rounded text-2xl " + (lang==='es'?"bg-emerald-100":"hover:bg-gray-100")} onClick={()=>setLang('es')} title="EspaÃ±ol">ðŸ‡ªðŸ‡¸</button>
                  <button className={"px-2 py-1 rounded text-2xl " + (lang==='en'?"bg-emerald-100":"hover:bg-gray-100")} onClick={()=>setLang('en')} title="English">ðŸ‡¬ðŸ‡§</button>
                  <button className={"px-2 py-1 rounded text-2xl " + (lang==='it'?"bg-emerald-100":"hover:bg-gray-100")} onClick={()=>setLang('it')} title="Italiano">ðŸ‡®ðŸ‡¹</button>
                  <button className={"px-2 py-1 rounded text-2xl " + (lang==='fr'?"bg-emerald-100":"hover:bg-gray-100")} onClick={()=>setLang('fr')} title="FranÃ§ais">ðŸ‡«ðŸ‡·</button>
                </div>
              </div>
              <div className="flex items-center gap-3">
                <div className="rounded-xl border px-3 py-1.5 bg-white text-sm">
                  {t('ui','basePriceLabel')}: <span className="font-semibold">{BASE_PRICE} â‚¬</span>
                </div>
                <div className="rounded-xl border px-3 py-1.5 bg-white text-sm">
                  {t('ui','extras')}: {`${t('ui','base')} +${EXTRA_PRICES.base}â‚¬, ${t('ui','protein')} +${EXTRA_PRICES.protein}â‚¬, ${t('ui','toppings')} +${EXTRA_PRICES.toppings}â‚¬, ${t('ui','sauce')} +${EXTRA_PRICES.sauce}â‚¬, ${t('ui','crunchy')} +${EXTRA_PRICES.crunchy}â‚¬`}
                </div>
              </div>
            </div>
          </header>

          <main className="mx-auto max-w-6xl px-4 py-8">
            {/* Preset bowls as clickable chips */}
            <section className="mb-8">
              <div className="mb-2 text-lg font-semibold">{t('ui','chefBowls')}</div>
              <div className="grid gap-2 sm:grid-cols-2 md:grid-cols-3">
                {PRESETS.map((p) => (
                  <PresetChip
                    key={p.key}
                    label={tp(p.key)}
                    price={p.price}
                    selected={isPresetSelected(p.key)}
                    onClick={() => togglePreset(p.key)}
                  />
                ))}
              </div>
            </section>

            {/* Custom builder */}
            <div className="rounded-3xl border bg-white p-6 shadow-sm">
              <div className="mb-6">
                <h2 className="text-2xl font-bold">{t('ui','buildTitle')}</h2>
                <p className="text-gray-500">{t('ui','limitsHint')}</p>
              </div>

              <Section title={t('ui','base')} hint={`${t('ui','base')} 1 Â· +${EXTRA_PRICES.base}â‚¬ extra`}>
                {BASES.map((k) => (
                  <Chip key={k} label={ti(k)} selected={selection.base.includes(k)} disabled={false} onClick={() => toggle('base', k)} />
                ))}
              </Section>

              <Section title={t('ui','protein')} hint={`${t('ui','protein')} 1 Â· +${EXTRA_PRICES.protein}â‚¬`}>
                {PROTEINS.map((k) => (
                  <Chip key={k} label={ti(k)} selected={selection.protein.includes(k)} disabled={disableNonBaseIngredients} onClick={() => toggle('protein', k)} />
                ))}
              </Section>

              <Section title={t('ui','toppings')} hint={`${t('ui','toppings')} 4 Â· +${EXTRA_PRICES.toppings}â‚¬ c/u`}>
                {TOPPINGS.map((k) => (
                  <Chip key={k} label={ti(k)} selected={selection.toppings.includes(k)} disabled={disableNonBaseIngredients} onClick={() => toggle('toppings', k)} />
                ))}
              </Section>

              <Section title={t('ui','sauce')} hint={`${t('ui','sauce')} 1 Â· +${EXTRA_PRICES.sauce}â‚¬`}>
                {SAUCES.map((k) => (
                  <Chip key={k} label={ti(k)} selected={selection.sauce.includes(k)} disabled={disableNonBaseIngredients} onClick={() => toggle('sauce', k)} />
                ))}
              </Section>

              <Section title={t('ui','crunchy')} hint={`${t('ui','crunchy')} 1 Â· +${EXTRA_PRICES.crunchy}â‚¬`}>
                {CRUNCHY.map((k) => (
                  <Chip key={k} label={ti(k)} selected={selection.crunchy.includes(k)} disabled={disableNonBaseIngredients} onClick={() => toggle('crunchy', k)} />
                ))}
              </Section>

              {/* Customer name (optional) + Summary */}
              <div className="mt-8 grid gap-6 md:grid-cols-2">
                <div className="rounded-2xl border p-5">
                  <h3 className="mb-3 text-lg font-semibold">{t('ui','detailsSummary')}</h3>

                  <label className="block text-sm font-medium mb-1" htmlFor="customerName">
                    {t('ui','customerNameOptional')}
                  </label>
                  <input
                    id="customerName"
                    type="text"
                    placeholder=""
                    value={customerName}
                    onChange={(e) => setCustomerName(e.target.value)}
                    className="mb-4 w-full rounded-xl border px-3 py-2"
                  />
                  <p className="text-xs text-gray-500 mb-4">{t('ui','pickupNote')}</p>

                  {presetOrders.length > 0 && (
                    <div className="mb-3">
                      <p className="font-medium">{t('ui','presetsSection')}:</p>
                      <ul className="list-disc ml-5 text-sm">
                        {presetOrders.map((k, i) => (
                          <li key={i}>{tp(k)}</li>
                        ))}
                      </ul>
                    </div>
                  )}

                  {hasPersonalized && (
                    <>
                      <p className="font-medium">{t('ui','customSection')}:</p>
                      <ul className="space-y-1 text-sm">
                        <li><span className="font-medium">{t('ui','base')}:</span> {selection.base.map(ti).join(', ') || 'â€”'}</li>
                        <li><span className="font-medium">{t('ui','protein')}:</span> {selection.protein.map(ti).join(', ') || 'â€”'}</li>
                        <li><span className="font-medium">{t('ui','toppings')}:</span> {selection.toppings.map(ti).join(', ') || 'â€”'}</li>
                        <li><span className="font-medium">{t('ui','sauce')}:</span> {selection.sauce.map(ti).join(', ') || 'â€”'}</li>
                        <li><span className="font-medium">{t('ui','crunchy')}:</span> {selection.crunchy.map(ti).join(', ') || 'â€”'}</li>
                      </ul>
                    </>
                  )}
                </div>

                <div className="rounded-2xl border p-5">
                  <h3 className="mb-3 text-lg font-semibold">{t('ui','total')}</h3>
                  <div className="space-y-1 text-sm">
                    <div className="flex justify-between"><span>{t('ui','subtotalPresets')}</span><span>{presetsSubtotal.toFixed(2)} â‚¬</span></div>
                    <div className="flex justify-between"><span>{t('ui','subtotalCustom')}</span><span>{personalizedSubtotal.toFixed(2)} â‚¬</span></div>
                    <div className="flex justify-between border-t pt-2 text-2xl font-extrabold"><span>{t('ui','total')}</span><span>{orderTotal} â‚¬</span></div>
                  </div>
                  <div className="mt-5 flex flex-col gap-2 sm:flex-row">
                    <a
                      href={whatsappHref}
                      onClick={(e) => { if (!hasAnyOrder) { e.preventDefault(); alert(lang==='es' ? 'Por favor, elige un preset o crea tu bowl.' : lang==='en' ? 'Please select a preset or create your bowl.' : lang==='it' ? 'Seleziona un bowl predefinito o crea il tuo.' : 'Veuillez sÃ©lectionner un bowl ou crÃ©er le vÃ´tre.'); } }}
                      target="_blank"
                      rel="noreferrer"
                      className={
                        "flex-1 rounded-xl px-4 py-3 text-center font-semibold text-white " +
                        (hasAnyOrder ? "bg-emerald-600 hover:bg-emerald-700" : "bg-gray-300 cursor-not-allowed")
                      }
                      title={t('ui','sendWhatsapp')}
                    >
                      {t('ui','sendWhatsapp')}
                    </a>
                    <button onClick={reset} className="rounded-xl border px-4 py-3 font-medium">{t('ui','reset')}</button>
                  </div>
                  <p className="mt-2 text-xs text-gray-500">*WhatsApp: +34 666 33 19 17</p>
                </div>
              </div>
            </div>

            <footer className="mt-10 text-center text-sm text-gray-500">
              <p>{t('ui','address')}</p>
            </footer>
          </main>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>

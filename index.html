<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Poke Bar â€“ Online Menu</title>
  <!-- Tailwind via CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- React 18 UMD + ReactDOM -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <!-- Babel for in-browser JSX transform -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="bg-emerald-50/40">
  <div id="root"></div>

  <script type="text/babel">
    const { useMemo, useState } = React;

    // --- Keys ------------------------------------------------------------
    const BASES = ["arroz_sushi", "quinoa", "ensalada"];
    const PROTEINS = [
      "salmon_crudo","salmon_tataki","salmon_teriyaki",
      "atun_crudo","atun_tataki","pulpo","tofu_plancha","pollo_teriyaki"
    ];
    const TOPPINGS = [
      "aguacate","mango","wakame","edamame","cebolla_caramelizada","cebolla_encurtida",
      "zanahoria","calabaza","calabacin_grill","tomate_cherry","tomate_seco","pepino",
      "col_morada","philadelphia","feta","jengibre_encurtido","huevas_pez"
    ];
    const SAUCES = [
      "spicy_mayo","soja","soja_sg","sriracha","salsa_mango","wasabi_cream","teriyaki","salsa_curry"
    ];
    const CRUNCHY = [
      "cebolla_crujiente","pistacho","almendra","anacardo","nori_crujiente","mix_semillas"
    ];

    const PRESETS = [
      { key: "el_clasico", price: 13 },
      { key: "bristol",    price: 15 },
      { key: "doramas",    price: 15 },
      { key: "ventahor",   price: 14 },
      { key: "pulp_fiction", price: 15 },
      { key: "ico",        price: 14 },
    ];

    const LIMITS = { base: 1, protein: 1, toppings: 4, sauce: 1, crunchy: 1 };
    const EXTRA_PRICES = { base: 2, protein: 3, toppings: 1.5, sauce: 1, crunchy: 1.5 };
    const BASE_PRICE = 13;

    // --- Translations ----------------------------------------------------
    const translations = {
      es: {
        flagsLabel: "Idioma",
        ui: {
          title: "Poke Bar",
          basePrice: "Precio base bowl",
          extras: "Extras",
          perItem: "c/u",
          buildTitle: "Crea tu poke",
          limitsHint: "Elige hasta: 1 base, 1 proteÃ­na, 4 toppings, 1 salsa, 1 crujiente.",
          quantity: "Cantidad",
          base: "Base",
          protein: "ProteÃ­na",
          toppings: "Toppings",
          sauce: "Salsa",
          crunchy: "Crujiente",
          addPreset: "AÃ±adir al pedido",
          dataSummary: "Datos y resumen",
          customerName: "Nombre del cliente",
          nameRequiredNote: "*Pedido para recogida en local.",
          nameRequiredAlert: "Por favor, escribe tu nombre para el pedido de recogida.",
          presetsSection: "Preset Bowls",
          customSection: "Custom Bowls",
          pricePerCustom: "Precio por custom bowl",
          subtotalPresets: "Subtotal presets",
          subtotalCustom: "Subtotal custom",
          total: "Total pedido",
          sendWhatsapp: "Enviar por WhatsApp",
          reset: "Reiniciar",
          pickupFooter: "Pedido para recogida en local.",
          address: "C/Lepanto 13L Â· Tel. 666 33 19 17 Â· Fuerteventura",
        },
        groups: { base:"Base", protein:"ProteÃ­na", toppings:"Toppings", sauce:"Salsa", crunchy:"Crujiente" },
        presets: {
          el_clasico:"El ClÃ¡sico", bristol:"Bristol", doramas:"Doramas",
          ventahor:"Ventahor", pulp_fiction:"Pulp Fiction", ico:"Ico"
        },
        ingredients: {
          arroz_sushi:"Arroz sushi", quinoa:"Quinoa", ensalada:"Ensalada",
          salmon_crudo:"SalmÃ³n (crudo)", salmon_tataki:"SalmÃ³n tataki", salmon_teriyaki:"SalmÃ³n teriyaki",
          atun_crudo:"AtÃºn (crudo)", atun_tataki:"AtÃºn tataki", pulpo:"Pulpo", tofu_plancha:"Tofu a la plancha",
          pollo_teriyaki:"Pollo teriyaki",
          aguacate:"Aguacate", mango:"Mango", wakame:"Alga wakame", edamame:"Edamame",
          cebolla_caramelizada:"Cebolla caramelizada", cebolla_encurtida:"Cebolla encurtida",
          zanahoria:"Zanahoria", calabaza:"Calabaza", calabacin_grill:"CalabacÃ­n parrillado",
          tomate_cherry:"Tomate cherry", tomate_seco:"Tomate seco", pepino:"Pepino",
          col_morada:"Col morada", philadelphia:"Philadelphia", feta:"Queso feta",
          jengibre_encurtido:"Jengibre encurtido", huevas_pez:"Huevas de pescado",
          spicy_mayo:"Spicy mayonesa", soja:"Soja", soja_sg:"Soja sin gluten",
          sriracha:"Salsa sriracha ðŸŒ¶", salsa_mango:"Salsa de mango", wasabi_cream:"Wasabi cream",
          teriyaki:"Teriyaki", salsa_curry:"Salsa curry",
          cebolla_crujiente:"Cebolla crujiente", pistacho:"Pistacho", almendra:"Almendra",
          anacardo:"Anacardo", nori_crujiente:"Alga nori crujiente", mix_semillas:"Mix de semillas",
        }
      },
      en: {
        flagsLabel: "Language",
        ui: {
          title: "Poke Bar",
          basePrice: "Bowl base price",
          extras: "Extras",
          perItem: "each",
          buildTitle: "Create your poke",
          limitsHint: "Choose up to: 1 base, 1 protein, 4 toppings, 1 sauce, 1 crunchy.",
          quantity: "Quantity",
          base: "Base",
          protein: "Protein",
          toppings: "Toppings",
          sauce: "Sauce",
          crunchy: "Crunchy",
          addPreset: "Add to order",
          dataSummary: "Details & summary",
          customerName: "Customer name",
          nameRequiredNote: "*Order for pick-up at the restaurant.",
          nameRequiredAlert: "Please enter your name for pick-up.",
          presetsSection: "Preset Bowls",
          customSection: "Custom Bowls",
          pricePerCustom: "Price per custom bowl",
          subtotalPresets: "Presets subtotal",
          subtotalCustom: "Custom subtotal",
          total: "Order total",
          sendWhatsapp: "Send via WhatsApp",
          reset: "Reset",
          pickupFooter: "Order for pick-up at the restaurant.",
          address: "C/Lepanto 13L Â· Tel. 666 33 19 17 Â· Fuerteventura",
        },
        groups: { base:"Base", protein:"Protein", toppings:"Toppings", sauce:"Sauce", crunchy:"Crunchy" },
        presets: {
          el_clasico:"The Classic", bristol:"Bristol", doramas:"Doramas",
          ventahor:"Ventahor", pulp_fiction:"Pulp Fiction", ico:"Ico"
        },
        ingredients: {
          arroz_sushi:"Sushi rice", quinoa:"Quinoa", ensalada:"Salad",
          salmon_crudo:"Salmon (raw)", salmon_tataki:"Salmon tataki", salmon_teriyaki:"Salmon teriyaki",
          atun_crudo:"Tuna (raw)", atun_tataki:"Tuna tataki", pulpo:"Octopus", tofu_plancha:"Grilled tofu",
          pollo_teriyaki:"Teriyaki chicken",
          aguacate:"Avocado", mango:"Mango", wakame:"Wakame seaweed", edamame:"Edamame",
          cebolla_caramelizada:"Caramelized onion", cebolla_encurtida:"Pickled onion",
          zanahoria:"Carrot", calabaza:"Pumpkin", calabacin_grill:"Grilled zucchini",
          tomate_cherry:"Cherry tomato", tomate_seco:"Sun-dried tomato", pepino:"Cucumber",
          col_morada:"Red cabbage", philadelphia:"Cream cheese", feta:"Feta cheese",
          jengibre_encurtido:"Pickled ginger", huevas_pez:"Fish roe",
          spicy_mayo:"Spicy mayo", soja:"Soy sauce", soja_sg:"Gluten-free soy sauce",
          sriracha:"Sriracha sauce ðŸŒ¶", salsa_mango:"Mango sauce", wasabi_cream:"Wasabi cream",
          teriyaki:"Teriyaki", salsa_curry:"Curry sauce",
          cebolla_crujiente:"Crispy onion", pistacho:"Pistachio", almendra:"Almond",
          anacardo:"Cashew", nori_crujiente:"Crispy nori", mix_semillas:"Seed mix",
        }
      },
      it: {
        flagsLabel: "Lingua",
        ui: {
          title: "Poke Bar",
          basePrice: "Prezzo base bowl",
          extras: "Extra",
          perItem: "cad.",
          buildTitle: "Crea il tuo poke",
          limitsHint: "Scegli fino a: 1 base, 1 proteina, 4 toppings, 1 salsa, 1 croccante.",
          quantity: "QuantitÃ ",
          base: "Base",
          protein: "Proteina",
          toppings: "Toppings",
          sauce: "Salsa",
          crunchy: "Croccante",
          addPreset: "Aggiungi all'ordine",
          dataSummary: "Dati e riepilogo",
          customerName: "Nome del cliente",
          nameRequiredNote: "*Ordine per ritiro in loco.",
          nameRequiredAlert: "Per favore, inserisci il tuo nome per il ritiro.",
          presetsSection: "Bowls predefiniti",
          customSection: "Bowls personalizzati",
          pricePerCustom: "Prezzo per bowl personalizzato",
          subtotalPresets: "Subtotale predefiniti",
          subtotalCustom: "Subtotale personalizzati",
          total: "Totale ordine",
          sendWhatsapp: "Invia via WhatsApp",
          reset: "Reimposta",
          pickupFooter: "Ordine per ritiro in loco.",
          address: "C/Lepanto 13L Â· Tel. 666 33 19 17 Â· Fuerteventura",
        },
        groups: { base:"Base", protein:"Proteina", toppings:"Toppings", sauce:"Salsa", crunchy:"Croccante" },
        presets: {
          el_clasico:"Il Classico", bristol:"Bristol", doramas:"Doramas",
          ventahor:"Ventahor", pulp_fiction:"Pulp Fiction", ico:"Ico"
        },
        ingredients: {
          arroz_sushi:"Riso sushi", quinoa:"Quinoa", ensalada:"Insalata",
          salmon_crudo:"Salmone (crudo)", salmon_tataki:"Salmone tataki", salmon_teriyaki:"Salmone teriyaki",
          atun_crudo:"Tonno (crudo)", atun_tataki:"Tonno tataki", pulpo:"Polpo", tofu_plancha:"Tofu alla piastra",
          pollo_teriyaki:"Pollo teriyaki",
          aguacate:"Avocado", mango:"Mango", wakame:"Alga wakame", edamame:"Edamame",
          cebolla_caramelizada:"Cipolla caramellata", cebolla_encurtida:"Cipolla marinata",
          zanahoria:"Carota", calabaza:"Zucca", calabacin_grill:"Zucchina alla griglia",
          tomate_cherry:"Pomodorini", tomate_seco:"Pomodoro secco", pepino:"Cetriolo",
          col_morada:"Cavolo rosso", philadelphia:"Formaggio cremoso (Philadelphia)", feta:"Formaggio feta",
          jengibre_encurtido:"Zenzero marinato", huevas_pez:"Uova di pesce",
          spicy_mayo:"Maionese piccante", soja:"Salsa di soia", soja_sg:"Salsa di soia senza glutine",
          sriracha:"Salsa sriracha ðŸŒ¶", salsa_mango:"Salsa di mango", wasabi_cream:"Crema al wasabi",
          teriyaki:"Teriyaki", salsa_curry:"Salsa al curry",
          cebolla_crujiente:"Cipolla croccante", pistacho:"Pistacchio", almendra:"Mandorla",
          anacardo:"Anacardo", nori_crujiente:"Alga nori croccante", mix_semillas:"Mix di semi",
        }
      },
      fr: {
        flagsLabel: "Langue",
        ui: {
          title: "Poke Bar",
          basePrice: "Prix de base du bowl",
          extras: "Extras",
          perItem: "ch.",
          buildTitle: "CrÃ©e ton poke",
          limitsHint: "Choisis jusquâ€™Ã  : 1 base, 1 protÃ©ine, 4 toppings, 1 sauce, 1 croustillant.",
          quantity: "QuantitÃ©",
          base: "Base",
          protein: "ProtÃ©ine",
          toppings: "Toppings",
          sauce: "Sauce",
          crunchy: "Croustillant",
          addPreset: "Ajouter Ã  la commande",
          dataSummary: "Infos & rÃ©capitulatif",
          customerName: "Nom du client",
          nameRequiredNote: "*Commande Ã  rÃ©cupÃ©rer sur place.",
          nameRequiredAlert: "Veuillez indiquer votre nom pour le retrait.",
          presetsSection: "Bowls prÃ©dÃ©finis",
          customSection: "Bowls personnalisÃ©s",
          pricePerCustom: "Prix par bowl personnalisÃ©",
          subtotalPresets: "Sous-total prÃ©dÃ©finis",
          subtotalCustom: "Sous-total personnalisÃ©s",
          total: "Total commande",
          sendWhatsapp: "Envoyer via WhatsApp",
          reset: "RÃ©initialiser",
          pickupFooter: "Commande Ã  rÃ©cupÃ©rer sur place.",
          address: "C/Lepanto 13L Â· TÃ©l. 666 33 19 17 Â· Fuerteventura",
        },
        groups: { base:"Base", protein:"ProtÃ©ine", toppings:"Toppings", sauce:"Sauce", crunchy:"Croustillant" },
        presets: {
          el_clasico:"Le Classique", bristol:"Bristol", doramas:"Doramas",
          ventahor:"Ventahor", pulp_fiction:"Pulp Fiction", ico:"Ico"
        },
        ingredients: {
          arroz_sushi:"Riz Ã  sushi", quinoa:"Quinoa", ensalada:"Salade",
          salmon_crudo:"Saumon (cru)", salmon_tataki:"Saumon tataki", salmon_teriyaki:"Saumon teriyaki",
          atun_crudo:"Thon (cru)", atun_tataki:"Thon tataki", pulpo:"Poulpe", tofu_plancha:"Tofu grillÃ©",
          pollo_teriyaki:"Poulet teriyaki",
          aguacate:"Avocat", mango:"Mangue", wakame:"Algues wakame", edamame:"Edamame",
          cebolla_caramelizada:"Oignon caramÃ©lisÃ©", cebolla_encurtida:"Oignon marinÃ©",
          zanahoria:"Carotte", calabaza:"Potiron", calabacin_grill:"Courgette grillÃ©e",
          tomate_cherry:"Tomate cerise", tomate_seco:"Tomate sÃ©chÃ©e", pepino:"Concombre",
          col_morada:"Chou rouge", philadelphia:"Fromage frais (Philadelphia)", feta:"Fromage feta",
          jengibre_encurtido:"Gingembre marinÃ©", huevas_pez:"Å’ufs de poisson",
          spicy_mayo:"Mayonnaise Ã©picÃ©e", soja:"Sauce soja", soja_sg:"Sauce soja sans gluten",
          sriracha:"Sauce sriracha ðŸŒ¶", salsa_mango:"Sauce mangue", wasabi_cream:"CrÃ¨me wasabi",
          teriyaki:"Teriyaki", salsa_curry:"Sauce curry",
          cebolla_crujiente:"Oignon croustillant", pistacho:"Pistache", almendra:"Amande",
          anacardo:"Noix de cajou", nori_crujiente:"Nori croustillant", mix_semillas:"MÃ©lange de graines",
        }
      }
    };

    // --- UI helpers ------------------------------------------------------
    const Section = ({ title, children, hint }) => (
      <section className="mb-6">
        <div className="flex items-end justify-between">
          <h2 className="text-xl font-semibold">{title}</h2>
          {hint && <p className="text-sm text-gray-500">{hint}</p>}
        </div>
        <div className="mt-3 grid gap-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4">{children}</div>
      </section>
    );

    const Chip = ({ label, selected, onClick }) => (
      <button
        className={
          "text-left rounded-2xl border px-4 py-3 shadow-sm transition " +
          (selected ? "border-emerald-500 ring-2 ring-emerald-200 bg-white " : "border-gray-200 hover:border-gray-300 bg-white ")
        }
        onClick={onClick}
        type="button"
      >
        <div className="flex items-center justify-between gap-3">
          <span className="font-medium">{label}</span>
          {selected && <span className="inline-flex h-5 w-5 items-center justify-center rounded-full bg-emerald-500 text-white text-xs">âœ“</span>}
        </div>
      </button>
    );

    // --- App -------------------------------------------------------------
    function App() {
      const [lang, setLang] = useState("es");
      const t = (section, key) => translations[lang][section][key];
      const ti = (key) => translations[lang].ingredients[key];
      const tp = (key) => translations[lang].presets[key];

      // Start custom qty at 0 so presets don't sum with a default custom bowl
      const [qty, setQty] = useState(0);
      const [selection, setSelection] = useState({ base: [], protein: [], toppings: [], sauce: [], crunchy: [] });
      const [presetOrders, setPresetOrders] = useState([]); // [{key, price}]
      const [customerName, setCustomerName] = useState("");

      const extras = useMemo(() => {
        const out = {};
        Object.entries({ base: BASES, protein: PROTEINS, toppings: TOPPINGS, sauce: SAUCES, crunchy: CRUNCHY })
          .forEach(([k]) => {
            const over = Math.max(0, (selection[k] || []).length - LIMITS[k]);
            out[k] = over * EXTRA_PRICES[k];
          });
        return out;
      }, [selection]);

      const extrasTotal = Object.values(extras).reduce((a, b) => a + b, 0);
      const bowlSubtotal = (qty > 0 ? (BASE_PRICE + extrasTotal) : 0);
      const customTotal = bowlSubtotal * qty;
      const presetsTotal = presetOrders.reduce((sum, p) => sum + p.price, 0);
      const orderTotal = (customTotal + presetsTotal).toFixed(2);

      const toggle = (group, itemKey) => {
        setSelection((prev) => {
          const exists = prev[group].includes(itemKey);
          const next = exists ? prev[group].filter((k) => k !== itemKey) : [...prev[group], itemKey];
          return { ...prev, [group]: next };
        });
      };

      const reset = () => {
        setSelection({ base: [], protein: [], toppings: [], sauce: [], crunchy: [] });
        setQty(0);
        setPresetOrders([]);
        setCustomerName("");
      };

      // When adding a preset, treat it as the order (not additive with a default custom):
      // - Clear custom selection and set qty = 0 so total reflects only preset(s)
      const addPreset = (preset) => {
        setPresetOrders([...presetOrders, preset]);
        setSelection({ base: [], protein: [], toppings: [], sauce: [], crunchy: [] });
        setQty(0);
      };

      // Nicely formatted multiline block for ingredients
      const listBlock = (arr) => arr.length ? ("\n- " + arr.map(ti).join("\n- ")) : " -";

      const shareText = () => {
        const ui = translations[lang].ui;
        const lines = [];
        lines.push(`${ui.customerName}: ${customerName.trim() || "-"}`);
        lines.push(ui.pickupFooter);
        lines.push("");

        if (presetOrders.length > 0) {
          lines.push(`${ui.presetsSection}:`);
          const counts = presetOrders.reduce((acc, p) => {
            acc[p.key] = (acc[p.key] || 0) + 1;
            return acc;
          }, {});
          Object.entries(counts).forEach(([k, c]) => {
            lines.push(`${tp(k)} Ã—${c}`);
          });
          lines.push(`${ui.subtotalPresets}: ${presetsTotal.toFixed(2)} â‚¬`);
          lines.push("");
        }

        if (qty > 0) {
          lines.push(`${ui.customSection}:`);
          lines.push(`${ui.quantity}: ${qty}`);
          lines.push(`${t("ui","base")}:${listBlock(selection.base)}`);
          lines.push(`${t("ui","protein")}:${listBlock(selection.protein)}`);
          lines.push(`${t("ui","toppings")}:${listBlock(selection.toppings)}`);
          lines.push(`${t("ui","sauce")}:${listBlock(selection.sauce)}`);
          lines.push(`${t("ui","crunchy")}:${listBlock(selection.crunchy)}`);
          lines.push(`${ui.pricePerCustom}: ${(BASE_PRICE + extrasTotal).toFixed(2)} â‚¬`);
          lines.push(`${ui.subtotalCustom}: ${customTotal.toFixed(2)} â‚¬`);
          lines.push("");
        }

        lines.push(`${ui.total}: ${orderTotal} â‚¬`);
        return encodeURIComponent(lines.join("\n"));
      };

      // Name required AND at least one item (preset or custom)
      const hasAnyOrder = presetOrders.length > 0 || qty > 0;
      const canSend = customerName.trim().length > 0 && hasAnyOrder;
      const whatsappHref = `https://wa.me/34666331917?text=${shareText()}`;

      // extras label by group
      const extrasLabel = () => {
        const g = translations[lang].groups;
        return [
          `${g.base} +${EXTRA_PRICES.base}â‚¬`,
          `${g.protein} +${EXTRA_PRICES.protein}â‚¬`,
          `${g.toppings} +${EXTRA_PRICES.toppings}â‚¬`,
          `${g.sauce} +${EXTRA_PRICES.sauce}â‚¬`,
          `${g.crunchy} +${EXTRA_PRICES.crunchy}â‚¬`,
        ].join(", ");
      };

      return (
        <div className="min-h-screen">
          {/* Header */}
          <header className="sticky top-0 z-10 bg-white/80 backdrop-blur border-b">
            <div className="mx-auto max-w-6xl px-4 py-4 flex flex-col gap-3 md:flex-row md:items-center md:justify-between">
              <div className="flex items-center gap-3">
                <h1 className="text-2xl font-bold tracking-tight">{t("ui","title")}</h1>
                <span className="text-sm text-gray-400">Â·</span>
                <div className="text-sm text-gray-600">{translations[lang].flagsLabel}:</div>
                <div className="flex gap-2">
                  <button className={"px-2 py-1 rounded text-2xl " + (lang==="es"?"bg-emerald-100":"hover:bg-gray-100")} onClick={()=>setLang("es")} title="EspaÃ±ol">ðŸ‡ªðŸ‡¸</button>
                  <button className={"px-2 py-1 rounded text-2xl " + (lang==="en"?"bg-emerald-100":"hover:bg-gray-100")} onClick={()=>setLang("en")} title="English">ðŸ‡¬ðŸ‡§</button>
                  <button className={"px-2 py-1 rounded text-2xl " + (lang==="it"?"bg-emerald-100":"hover:bg-gray-100")} onClick={()=>setLang("it")} title="Italiano">ðŸ‡®ðŸ‡¹</button>
                  <button className={"px-2 py-1 rounded text-2xl " + (lang==="fr"?"bg-emerald-100":"hover:bg-gray-100")} onClick={()=>setLang("fr")} title="FranÃ§ais">ðŸ‡«ðŸ‡·</button>
                </div>
              </div>
              <div className="flex items-center gap-3">
                <div className="rounded-xl border px-3 py-1.5 bg-white text-sm">
                  {t("ui","basePrice")}: <span className="font-semibold">{BASE_PRICE} â‚¬</span>
                </div>
                <div className="rounded-xl border px-3 py-1.5 bg-white text-sm">
                  {t("ui","extras")}: {extrasLabel()}
                </div>
              </div>
            </div>
          </header>

          <main className="mx-auto max-w-6xl px-4 py-8">
            {/* Preset bowls */}
            <div className="mb-10 grid gap-4 md:grid-cols-3">
              {PRESETS.map((p) => (
                <div key={p.key} className="rounded-2xl border bg-white p-5 shadow-sm">
                  <div className="flex items-center justify-between">
                    <div>
                      <h3 className="text-lg font-semibold">{tp(p.key)}</h3>
                      <p className="text-sm text-gray-500">Bowl</p>
                    </div>
                    <div className="text-lg font-bold">{p.price} â‚¬</div>
                  </div>
                  <button
                    className="mt-4 w-full rounded-xl border border-emerald-500 bg-emerald-500/10 px-4 py-2 text-emerald-700 hover:bg-emerald-500/15"
                    onClick={() => addPreset(p)}
                  >
                    {t("ui","addPreset")}
                  </button>
                </div>
              ))}
            </div>

            {/* Custom builder */}
            <div className="rounded-3xl border bg-white p-6 shadow-sm">
              <div className="mb-6 flex items-start justify-between gap-4">
                <div>
                  <h2 className="text-2xl font-bold">{t("ui","buildTitle")}</h2>
                  <p className="text-gray-500">{t("ui","limitsHint")}</p>
                </div>
                <div className="flex items-center gap-2">
                  <label className="text-sm text-gray-600">{t("ui","quantity")}</label>
                  <input
                    type="number"
                    min={0}
                    value={qty}
                    onChange={(e) => setQty(Math.max(0, parseInt(e.target.value || "0")))}
                    className="w-24 rounded-xl border px-3 py-2"
                  />
                </div>
              </div>

              <Section title={t("ui","base")}>
                {BASES.map((k) => (
                  <Chip key={k} label={ti(k)} selected={selection.base.includes(k)} onClick={() => toggle("base", k)} />
                ))}
              </Section>

              <Section title={t("ui","protein")}>
                {PROTEINS.map((k) => (
                  <Chip key={k} label={ti(k)} selected={selection.protein.includes(k)} onClick={() => toggle("protein", k)} />
                ))}
              </Section>

              <Section title={t("ui","toppings")}>
                {TOPPINGS.map((k) => (
                  <Chip key={k} label={ti(k)} selected={selection.toppings.includes(k)} onClick={() => toggle("toppings", k)} />
                ))}
              </Section>

              <Section title={t("ui","sauce")}>
                {SAUCES.map((k) => (
                  <Chip key={k} label={ti(k)} selected={selection.sauce.includes(k)} onClick={() => toggle("sauce", k)} />
                ))}
              </Section>

              <Section title={t("ui","crunchy")}>
                {CRUNCHY.map((k) => (
                  <Chip key={k} label={ti(k)} selected={selection.crunchy.includes(k)} onClick={() => toggle("crunchy", k)} />
                ))}
              </Section>

              {/* Name + Summary + Total */}
              <div className="mt-8 grid gap-6 md:grid-cols-2">
                <div className="rounded-2xl border p-5">
                  <h3 className="mb-3 text-lg font-semibold">{t("ui","dataSummary")}</h3>

                  <label className="block text-sm font-medium mb-1" htmlFor="customerName">
                    {t("ui","customerName")} <span className="text-red-600">*</span>
                  </label>
                  <input
                    id="customerName"
                    type="text"
                    value={customerName}
                    onChange={(e) => setCustomerName(e.target.value)}
                    className="mb-4 w-full rounded-xl border px-3 py-2"
                    required
                  />
                  <p className="text-xs text-gray-500 mb-4">{t("ui","nameRequiredNote")}</p>

                  {presetOrders.length > 0 && (
                    <div className="mb-3">
                      <p className="font-medium">{t("ui","presetsSection")}:</p>
                      <ul className="list-disc ml-5 text-sm">
                        {presetOrders.map((p, i) => (
                          <li key={i}>{tp(p.key)} - {p.price} â‚¬</li>
                        ))}
                      </ul>
                    </div>
                  )}

                  {qty > 0 && (
                    <>
                      <p className="font-medium">{t("ui","customSection")}:</p>
                      <ul className="space-y-1 text-sm">
                        <li><span className="font-medium">{t("ui","quantity")}:</span> x{qty}</li>
                        <li><span className="font-medium">{t("ui","base")}:</span> {selection.base.map(ti).join(", ") || "â€”"}</li>
                        <li><span className="font-medium">{t("ui","protein")}:</span> {selection.protein.map(ti).join(", ") || "â€”"}</li>
                        <li><span className="font-medium">{t("ui","toppings")}:</span> {selection.toppings.map(ti).join(", ") || "â€”"}</li>
                        <li><span className="font-medium">{t("ui","sauce")}:</span> {selection.sauce.map(ti).join(", ") || "â€”"}</li>
                        <li><span className="font-medium">{t("ui","crunchy")}:</span> {selection.crunchy.map(ti).join(", ") || "â€”"}</li>
                      </ul>
                    </>
                  )}
                </div>

                <div className="rounded-2xl border p-5">
                  <h3 className="mb-3 text-lg font-semibold">{t("ui","total")}</h3>
                  <div className="space-y-1 text-sm">
                    <div className="flex justify-between"><span>{t("ui","subtotalPresets")}</span><span>{presetsTotal.toFixed(2)} â‚¬</span></div>
                    <div className="flex justify-between"><span>{t("ui","subtotalCustom")}</span><span>{customTotal.toFixed(2)} â‚¬</span></div>
                    <div className="flex justify-between border-t pt-2 text-2xl font-extrabold"><span>{t("ui","total")}</span><span>{orderTotal} â‚¬</span></div>
                  </div>

                  <div className="mt-5 flex flex-col gap-2 sm:flex-row">
                    <a
                      href={canSend ? `https://wa.me/34666331917?text=${shareText()}` : "#"}
                      onClick={(e) => { if (!canSend) { e.preventDefault(); alert(t("ui","nameRequiredAlert")); } }}
                      aria-disabled={!canSend}
                      className={
                        "flex-1 rounded-xl px-4 py-3 text-center font-semibold text-white " +
                        (canSend ? "bg-emerald-600 hover:bg-emerald-700" : "bg-gray-300 cursor-not-allowed pointer-events-none")
                      }
                      title={canSend ? t("ui","sendWhatsapp") : t("ui","nameRequiredAlert")}
                    >
                      {t("ui","sendWhatsapp")}
                    </a>
                    <button onClick={reset} className="rounded-xl border px-4 py-3 font-medium">{t("ui","reset")}</button>
                  </div>
                  <p className="mt-2 text-xs text-gray-500">*WhatsApp: +34 666 33 19 17</p>
                </div>
              </div>
            </div>

            <footer className="mt-10 text-center text-sm text-gray-500">
              <p>{t("ui","address")}</p>
              <p className="mt-1">{t("ui","pickupFooter")}</p>
            </footer>
          </main>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById("root"));
    root.render(<App />);
  </script>
</body>
</html>
